Add cache below txn/logging layer

Add an icache, but simpler now

Test for reallocating inode before shrunk

directories ls: if lock ordering problem, return what we have read so far

error codes
  write cnt = 0 should return which error happened

log absorption

test out of fs space

check that inodes are not modified on disk on abort
  e.g., nlink on failure to add to dir

mtime

performance measurements

end-to-end tests for recovery

goosify

log-by-pass writes


== some performance

--- small ---

Linux:
export /srv/nfs
sudo mount --bind /tmp/nfs /srv/nfs/bench
sudo mount -t nfs -o vers=3 localhost:/srv/nfs/bench /mnt/nfs
[goose-nfs (master)]$ ~/hack/fscq-impl/bench/smallfile /mnt/nfs/bench/
10440 files per 1000034 usec
   much time spent in LookupName (0.93s out of 2.37)

Goose:

[goose-nfs (master)]$ go test -v -cpuprofile cpu.prof -memprofil
goos: linux
goarch: amd64
pkg: github.com/mit-pdos/goose-nfsd
BenchmarkSmall-8           26823             40653 ns/op
PASS
ok      github.com/mit-pdos/goose-nfsd  3.316s


[goose-nfs (master)]$  ~/hack/fscq-impl/bench/smallfile /mnt/nfs
3068 files per 1000284 usec
[goose-nfs (master)]$ ls /mnt/nfs

--- large ---

Linux:

[goose-nfs (master)]$ showmount -e
Export list for fk6x1:
/srv/nfs/bench localhost
/srv/nfs       localhost
[goose-nfs (master)]$ sudo mount -t nfs -o vers=3 localhost:/srv/nfs/bench /mnt/nfs
[goose-nfs (master)]$ ~/hack/fscq-impl/bench/largefile /mnt/nfs
makefile 50 MB 40476 usec throughput 1264947.1 KB/s
writefile 50 MB 30536 usec throughput 1676709.5 KB/s

Goose:

[goose-nfs (master)]$ sudo mount -t nfs -o vers=3 localhost:/ /mnt/nfs
[goose-nfs (master)]$ ~/hack/fscq-impl/bench/largefile  /mnt/nfs
makefile 50 MB 468844 usec throughput 109204.8 KB/s
writefile 50 MB 308590 usec throughput 165915.9 KB/s
[goose-nfs (master)]$

[goose-nfs (master)]$ ~/hack/fscq-impl/bench/largefile  /mnt/nfs
makefile 50 MB 408314 usec throughput 125393.7 KB/s
writefile 50 MB 238106 usec throughput 215030.3 KB/s

[goose-nfs (master)]$ go test -v  -bench Large -run=^$ 
goos: linux
goarch: amd64
pkg: github.com/mit-pdos/goose-nfsd
BenchmarkLargeFile-8           7         150782653 ns/op
